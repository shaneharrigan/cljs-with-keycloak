{
"version":3,
"file":"module$node_modules$browserify_aes$authCipher.js",
"lineCount":91,
"mappings":"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",
"sources":["node_modules/browserify-aes/authCipher.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$browserify_aes$authCipher\"] = function(global,require,module,exports) {\nvar aes = require('./aes')\nvar Buffer = require('safe-buffer').Buffer\nvar Transform = require('cipher-base')\nvar inherits = require('inherits')\nvar GHASH = require('./ghash')\nvar xor = require('buffer-xor')\nvar incr32 = require('./incr32')\n\nfunction xorTest (a, b) {\n  var out = 0\n  if (a.length !== b.length) out++\n\n  var len = Math.min(a.length, b.length)\n  for (var i = 0; i < len; ++i) {\n    out += (a[i] ^ b[i])\n  }\n\n  return out\n}\n\nfunction calcIv (self, iv, ck) {\n  if (iv.length === 12) {\n    self._finID = Buffer.concat([iv, Buffer.from([0, 0, 0, 1])])\n    return Buffer.concat([iv, Buffer.from([0, 0, 0, 2])])\n  }\n  var ghash = new GHASH(ck)\n  var len = iv.length\n  var toPad = len % 16\n  ghash.update(iv)\n  if (toPad) {\n    toPad = 16 - toPad\n    ghash.update(Buffer.alloc(toPad, 0))\n  }\n  ghash.update(Buffer.alloc(8, 0))\n  var ivBits = len * 8\n  var tail = Buffer.alloc(8)\n  tail.writeUIntBE(ivBits, 0, 8)\n  ghash.update(tail)\n  self._finID = ghash.state\n  var out = Buffer.from(self._finID)\n  incr32(out)\n  return out\n}\nfunction StreamCipher (mode, key, iv, decrypt) {\n  Transform.call(this)\n\n  var h = Buffer.alloc(4, 0)\n\n  this._cipher = new aes.AES(key)\n  var ck = this._cipher.encryptBlock(h)\n  this._ghash = new GHASH(ck)\n  iv = calcIv(this, iv, ck)\n\n  this._prev = Buffer.from(iv)\n  this._cache = Buffer.allocUnsafe(0)\n  this._secCache = Buffer.allocUnsafe(0)\n  this._decrypt = decrypt\n  this._alen = 0\n  this._len = 0\n  this._mode = mode\n\n  this._authTag = null\n  this._called = false\n}\n\ninherits(StreamCipher, Transform)\n\nStreamCipher.prototype._update = function (chunk) {\n  if (!this._called && this._alen) {\n    var rump = 16 - (this._alen % 16)\n    if (rump < 16) {\n      rump = Buffer.alloc(rump, 0)\n      this._ghash.update(rump)\n    }\n  }\n\n  this._called = true\n  var out = this._mode.encrypt(this, chunk)\n  if (this._decrypt) {\n    this._ghash.update(chunk)\n  } else {\n    this._ghash.update(out)\n  }\n  this._len += chunk.length\n  return out\n}\n\nStreamCipher.prototype._final = function () {\n  if (this._decrypt && !this._authTag) throw new Error('Unsupported state or unable to authenticate data')\n\n  var tag = xor(this._ghash.final(this._alen * 8, this._len * 8), this._cipher.encryptBlock(this._finID))\n  if (this._decrypt && xorTest(tag, this._authTag)) throw new Error('Unsupported state or unable to authenticate data')\n\n  this._authTag = tag\n  this._cipher.scrub()\n}\n\nStreamCipher.prototype.getAuthTag = function getAuthTag () {\n  if (this._decrypt || !Buffer.isBuffer(this._authTag)) throw new Error('Attempting to get auth tag in unsupported state')\n\n  return this._authTag\n}\n\nStreamCipher.prototype.setAuthTag = function setAuthTag (tag) {\n  if (!this._decrypt) throw new Error('Attempting to set auth tag in unsupported state')\n\n  this._authTag = tag\n}\n\nStreamCipher.prototype.setAAD = function setAAD (buf) {\n  if (this._called) throw new Error('Attempting to set AAD in unsupported state')\n\n  this._ghash.update(buf)\n  this._alen += buf.length\n}\n\nmodule.exports = StreamCipher\n\n};"],
"names":["shadow$provide","global","require","module","exports","StreamCipher","mode","key","iv","decrypt","Transform","call","h","Buffer","alloc","_cipher","aes","AES","ck","encryptBlock","_ghash","GHASH","length","self","_finID","concat","from","ghash","len","toPad","update","ivBits","tail","writeUIntBE","state","out","incr32","_prev","_cache","allocUnsafe","_secCache","_decrypt","_len","_alen","_mode","_authTag","_called","inherits","xor","prototype","_update","StreamCipher.prototype._update","chunk","rump","encrypt","_final","StreamCipher.prototype._final","Error","tag","final","a","b","Math","min","i","scrub","getAuthTag","StreamCipher.prototype.getAuthTag","isBuffer","setAuthTag","StreamCipher.prototype.setAuthTag","setAAD","StreamCipher.prototype.setAAD","buf"]
}
