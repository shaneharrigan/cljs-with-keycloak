{
"version":3,
"file":"module$node_modules$miller_rabin$lib$mr.js",
"lineCount":80,
"mappings":"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",
"sources":["node_modules/miller-rabin/lib/mr.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$miller_rabin$lib$mr\"] = function(global,require,module,exports) {\nvar bn = require('bn.js');\nvar brorand = require('brorand');\n\nfunction MillerRabin(rand) {\n  this.rand = rand || new brorand.Rand();\n}\nmodule.exports = MillerRabin;\n\nMillerRabin.create = function create(rand) {\n  return new MillerRabin(rand);\n};\n\nMillerRabin.prototype._randbelow = function _randbelow(n) {\n  var len = n.bitLength();\n  var min_bytes = Math.ceil(len / 8);\n\n  // Generage random bytes until a number less than n is found.\n  // This ensures that 0..n-1 have an equal probability of being selected.\n  do\n    var a = new bn(this.rand.generate(min_bytes));\n  while (a.cmp(n) >= 0);\n\n  return a;\n};\n\nMillerRabin.prototype._randrange = function _randrange(start, stop) {\n  // Generate a random number greater than or equal to start and less than stop.\n  var size = stop.sub(start);\n  return start.add(this._randbelow(size));\n};\n\nMillerRabin.prototype.test = function test(n, k, cb) {\n  var len = n.bitLength();\n  var red = bn.mont(n);\n  var rone = new bn(1).toRed(red);\n\n  if (!k)\n    k = Math.max(1, (len / 48) | 0);\n\n  // Find d and s, (n - 1) = (2 ^ s) * d;\n  var n1 = n.subn(1);\n  for (var s = 0; !n1.testn(s); s++) {}\n  var d = n.shrn(s);\n\n  var rn1 = n1.toRed(red);\n\n  var prime = true;\n  for (; k > 0; k--) {\n    var a = this._randrange(new bn(2), n1);\n    if (cb)\n      cb(a);\n\n    var x = a.toRed(red).redPow(d);\n    if (x.cmp(rone) === 0 || x.cmp(rn1) === 0)\n      continue;\n\n    for (var i = 1; i < s; i++) {\n      x = x.redSqr();\n\n      if (x.cmp(rone) === 0)\n        return false;\n      if (x.cmp(rn1) === 0)\n        break;\n    }\n\n    if (i === s)\n      return false;\n  }\n\n  return prime;\n};\n\nMillerRabin.prototype.getDivisor = function getDivisor(n, k) {\n  var len = n.bitLength();\n  var red = bn.mont(n);\n  var rone = new bn(1).toRed(red);\n\n  if (!k)\n    k = Math.max(1, (len / 48) | 0);\n\n  // Find d and s, (n - 1) = (2 ^ s) * d;\n  var n1 = n.subn(1);\n  for (var s = 0; !n1.testn(s); s++) {}\n  var d = n.shrn(s);\n\n  var rn1 = n1.toRed(red);\n\n  for (; k > 0; k--) {\n    var a = this._randrange(new bn(2), n1);\n\n    var g = n.gcd(a);\n    if (g.cmpn(1) !== 0)\n      return g;\n\n    var x = a.toRed(red).redPow(d);\n    if (x.cmp(rone) === 0 || x.cmp(rn1) === 0)\n      continue;\n\n    for (var i = 1; i < s; i++) {\n      x = x.redSqr();\n\n      if (x.cmp(rone) === 0)\n        return x.fromRed().subn(1).gcd(n);\n      if (x.cmp(rn1) === 0)\n        break;\n    }\n\n    if (i === s) {\n      x = x.redSqr();\n      return x.fromRed().subn(1).gcd(n);\n    }\n  }\n\n  return false;\n};\n\n};"],
"names":["shadow$provide","global","require","module","exports","MillerRabin","rand","brorand","Rand","bn","create","MillerRabin.create","prototype","_randbelow","MillerRabin.prototype._randbelow","n","len","bitLength","min_bytes","Math","ceil","a","generate","cmp","_randrange","MillerRabin.prototype._randrange","start","stop","size","sub","add","test","MillerRabin.prototype.test","k","cb","red","mont","rone","toRed","max","n1","subn","s","testn","d","shrn","rn1","x","redPow","i","redSqr","prime","getDivisor","MillerRabin.prototype.getDivisor","g","gcd","cmpn","fromRed"]
}
