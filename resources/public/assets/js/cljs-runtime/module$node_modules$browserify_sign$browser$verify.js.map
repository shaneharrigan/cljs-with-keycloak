{
"version":3,
"file":"module$node_modules$browserify_sign$browser$verify.js",
"lineCount":67,
"mappings":"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",
"sources":["node_modules/browserify-sign/browser/verify.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$browserify_sign$browser$verify\"] = function(global,require,module,exports) {\n'use strict';\n\n// much of this based on https://github.com/indutny/self-signed/blob/gh-pages/lib/rsa.js\nvar Buffer = require('safe-buffer').Buffer;\nvar BN = require('bn.js');\nvar EC = require('elliptic').ec;\nvar parseKeys = require('parse-asn1');\nvar curves = require('./curves.json');\n\nfunction verify(sig, hash, key, signType, tag) {\n  var pub = parseKeys(key);\n  if (pub.type === 'ec') {\n    // rsa keys can be interpreted as ecdsa ones in openssl\n    if (signType !== 'ecdsa' && signType !== 'ecdsa/rsa') { throw new Error('wrong public key type'); }\n    return ecVerify(sig, hash, pub);\n  } else if (pub.type === 'dsa') {\n    if (signType !== 'dsa') { throw new Error('wrong public key type'); }\n    return dsaVerify(sig, hash, pub);\n  }\n  if (signType !== 'rsa' && signType !== 'ecdsa/rsa') { throw new Error('wrong public key type'); }\n\n  hash = Buffer.concat([tag, hash]);\n  var len = pub.modulus.byteLength();\n  var pad = [1];\n  var padNum = 0;\n  while (hash.length + pad.length + 2 < len) {\n    pad.push(0xff);\n    padNum += 1;\n  }\n  pad.push(0x00);\n  var i = -1;\n  while (++i < hash.length) {\n    pad.push(hash[i]);\n  }\n  pad = Buffer.from(pad);\n  var red = BN.mont(pub.modulus);\n  sig = new BN(sig).toRed(red);\n\n  sig = sig.redPow(new BN(pub.publicExponent));\n  sig = Buffer.from(sig.fromRed().toArray());\n  var out = padNum < 8 ? 1 : 0;\n  len = Math.min(sig.length, pad.length);\n  if (sig.length !== pad.length) { out = 1; }\n\n  i = -1;\n  while (++i < len) { out |= sig[i] ^ pad[i]; }\n  return out === 0;\n}\n\nfunction ecVerify(sig, hash, pub) {\n  var curveId = curves[pub.data.algorithm.curve.join('.')];\n  if (!curveId) { throw new Error('unknown curve ' + pub.data.algorithm.curve.join('.')); }\n\n  var curve = new EC(curveId);\n  var pubkey = pub.data.subjectPrivateKey.data;\n\n  return curve.verify(hash, sig, pubkey);\n}\n\nfunction dsaVerify(sig, hash, pub) {\n  var p = pub.data.p;\n  var q = pub.data.q;\n  var g = pub.data.g;\n  var y = pub.data.pub_key;\n  var unpacked = parseKeys.signature.decode(sig, 'der');\n  var s = unpacked.s;\n  var r = unpacked.r;\n  checkValue(s, q);\n  checkValue(r, q);\n  var montp = BN.mont(p);\n  var w = s.invm(q);\n  var v = g.toRed(montp)\n    .redPow(new BN(hash).mul(w).mod(q))\n    .fromRed()\n    .mul(y.toRed(montp).redPow(r.mul(w).mod(q)).fromRed())\n    .mod(p)\n    .mod(q);\n  return v.cmp(r) === 0;\n}\n\nfunction checkValue(b, q) {\n  if (b.cmpn(0) <= 0) { throw new Error('invalid sig'); }\n  if (b.cmp(q) >= 0) { throw new Error('invalid sig'); }\n}\n\nmodule.exports = verify;\n\n};"],
"names":["shadow$provide","global","require","module","exports","checkValue","b","q","cmpn","Error","cmp","Buffer","BN","EC","ec","parseKeys","curves","verify","sig","hash","key","signType","tag","pub","type","curveId","data","algorithm","curve","join","subjectPrivateKey","p","g","y","pub_key","unpacked","signature","decode","s","r","montp","mont","w","invm","toRed","redPow","mul","mod","fromRed","v","concat","len","modulus","byteLength","pad","padNum","length","push","i","from","red","publicExponent","toArray","out","Math","min"]
}
