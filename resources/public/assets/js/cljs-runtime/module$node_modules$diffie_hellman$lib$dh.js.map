{
"version":3,
"file":"module$node_modules$diffie_hellman$lib$dh.js",
"lineCount":92,
"mappings":"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",
"sources":["node_modules/diffie-hellman/lib/dh.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$diffie_hellman$lib$dh\"] = function(global,require,module,exports) {\nvar Buffer = require('buffer').Buffer;\nvar BN = require('bn.js');\nvar MillerRabin = require('miller-rabin');\nvar millerRabin = new MillerRabin();\nvar TWENTYFOUR = new BN(24);\nvar ELEVEN = new BN(11);\nvar TEN = new BN(10);\nvar THREE = new BN(3);\nvar SEVEN = new BN(7);\nvar primes = require('./generatePrime');\nvar randomBytes = require('randombytes');\nmodule.exports = DH;\n\nfunction setPublicKey(pub, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(pub)) {\n    pub = new Buffer(pub, enc);\n  }\n  this._pub = new BN(pub);\n  return this;\n}\n\nfunction setPrivateKey(priv, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(priv)) {\n    priv = new Buffer(priv, enc);\n  }\n  this._priv = new BN(priv);\n  return this;\n}\n\nvar primeCache = {};\nfunction checkPrime(prime, generator) {\n  var gen = generator.toString('hex');\n  var hex = [gen, prime.toString(16)].join('_');\n  if (hex in primeCache) {\n    return primeCache[hex];\n  }\n  var error = 0;\n\n  if (prime.isEven() ||\n    !primes.simpleSieve ||\n    !primes.fermatTest(prime) ||\n    !millerRabin.test(prime)) {\n    //not a prime so +1\n    error += 1;\n\n    if (gen === '02' || gen === '05') {\n      // we'd be able to check the generator\n      // it would fail so +8\n      error += 8;\n    } else {\n      //we wouldn't be able to test the generator\n      // so +4\n      error += 4;\n    }\n    primeCache[hex] = error;\n    return error;\n  }\n  if (!millerRabin.test(prime.shrn(1))) {\n    //not a safe prime\n    error += 2;\n  }\n  var rem;\n  switch (gen) {\n    case '02':\n      if (prime.mod(TWENTYFOUR).cmp(ELEVEN)) {\n        // unsuidable generator\n        error += 8;\n      }\n      break;\n    case '05':\n      rem = prime.mod(TEN);\n      if (rem.cmp(THREE) && rem.cmp(SEVEN)) {\n        // prime mod 10 needs to equal 3 or 7\n        error += 8;\n      }\n      break;\n    default:\n      error += 4;\n  }\n  primeCache[hex] = error;\n  return error;\n}\n\nfunction DH(prime, generator, malleable) {\n  this.setGenerator(generator);\n  this.__prime = new BN(prime);\n  this._prime = BN.mont(this.__prime);\n  this._primeLen = prime.length;\n  this._pub = undefined;\n  this._priv = undefined;\n  this._primeCode = undefined;\n  if (malleable) {\n    this.setPublicKey = setPublicKey;\n    this.setPrivateKey = setPrivateKey;\n  } else {\n    this._primeCode = 8;\n  }\n}\nObject.defineProperty(DH.prototype, 'verifyError', {\n  enumerable: true,\n  get: function () {\n    if (typeof this._primeCode !== 'number') {\n      this._primeCode = checkPrime(this.__prime, this.__gen);\n    }\n    return this._primeCode;\n  }\n});\nDH.prototype.generateKeys = function () {\n  if (!this._priv) {\n    this._priv = new BN(randomBytes(this._primeLen));\n  }\n  this._pub = this._gen.toRed(this._prime).redPow(this._priv).fromRed();\n  return this.getPublicKey();\n};\n\nDH.prototype.computeSecret = function (other) {\n  other = new BN(other);\n  other = other.toRed(this._prime);\n  var secret = other.redPow(this._priv).fromRed();\n  var out = new Buffer(secret.toArray());\n  var prime = this.getPrime();\n  if (out.length < prime.length) {\n    var front = new Buffer(prime.length - out.length);\n    front.fill(0);\n    out = Buffer.concat([front, out]);\n  }\n  return out;\n};\n\nDH.prototype.getPublicKey = function getPublicKey(enc) {\n  return formatReturnValue(this._pub, enc);\n};\n\nDH.prototype.getPrivateKey = function getPrivateKey(enc) {\n  return formatReturnValue(this._priv, enc);\n};\n\nDH.prototype.getPrime = function (enc) {\n  return formatReturnValue(this.__prime, enc);\n};\n\nDH.prototype.getGenerator = function (enc) {\n  return formatReturnValue(this._gen, enc);\n};\n\nDH.prototype.setGenerator = function (gen, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(gen)) {\n    gen = new Buffer(gen, enc);\n  }\n  this.__gen = gen;\n  this._gen = new BN(gen);\n  return this;\n};\n\nfunction formatReturnValue(bn, enc) {\n  var buf = new Buffer(bn.toArray());\n  if (!enc) {\n    return buf;\n  } else {\n    return buf.toString(enc);\n  }\n}\n\n};"],
"names":["shadow$provide","global","require","module","exports","setPublicKey","pub","enc","Buffer","isBuffer","_pub","BN","setPrivateKey","priv","_priv","DH","prime","generator","malleable","setGenerator","__prime","_prime","mont","_primeLen","length","_primeCode","undefined","formatReturnValue","bn","buf","toArray","toString","millerRabin","MillerRabin","TWENTYFOUR","ELEVEN","TEN","THREE","SEVEN","primes","randomBytes","primeCache","Object","defineProperty","prototype","enumerable","get","gen","__gen","hex","join","error","isEven","simpleSieve","fermatTest","test","shrn","mod","cmp","rem","generateKeys","DH.prototype.generateKeys","_gen","toRed","redPow","fromRed","getPublicKey","computeSecret","DH.prototype.computeSecret","other","secret","out","getPrime","front","fill","concat","DH.prototype.getPublicKey","getPrivateKey","DH.prototype.getPrivateKey","DH.prototype.getPrime","getGenerator","DH.prototype.getGenerator","DH.prototype.setGenerator"]
}
